Relatório de Engenharia de Sistemas Pedagógicos: Integração da Arquitetura Meta-Racional Poetiq na IDE Antigravity para o Projeto 'Matemática Viva'Sumário ExecutivoEste relatório apresenta uma análise exaustiva e uma arquitetura técnica detalhada para a integração da meta-estrutura de raciocínio da Poetiq.ai dentro da Google Antigravity IDE. O objetivo central é a transformação dos processos de criação, manutenção e validação do projeto educacional 'Matemática Viva', assegurando uma adesão algorítmica rigorosa aos documentos de governança (Constituição, Magna Carta, Matriz K-12) e à tríade pedagógica (Charlotte Mason, Matemática de Singapura, The Good and the Beautiful - TGTB).A investigação demonstra que a abordagem tradicional de geração de código e conteúdo via LLMs (Large Language Models) é insuficiente para a complexidade das restrições pedagógicas exigidas. Em contrapartida, a implementação de agentes recursivos baseados no Agent Development Kit (ADK) da Antigravity, operando sob a lógica de refinamento iterativo da Poetiq ("Generate-Verify-Refine"), oferece uma solução robusta. Ao orquestrar modelos de "raciocínio profundo" como Gemini 3 Pro e Claude Opus/Sonnet (Thinking), e conectar a base de conhecimento estática através do Model Context Protocol (MCP), estabelece-se um pipeline de "Engenharia Pedagógica Assistida por Agentes" (PASE). Este sistema não apenas acelera a produção, mas garante que cada artefato gerado seja "constitucionalmente" válido antes de ser submetido à revisão humana.1. Introdução: O Imperativo da Agência na Engenharia Pedagógica1.1 A Evolução das Ferramentas de Desenvolvimento: De Editores a Plataformas AgênticasO cenário de desenvolvimento de software e, por extensão, a engenharia de currículos complexos, atravessa um ponto de inflexão histórico. As ferramentas tradicionais, centradas na edição de texto assistida (como o VS Code clássico com IntelliSense), estão sendo rapidamente suplantadas por Ambientes de Desenvolvimento Agêntico (Agentic IDEs). A Google Antigravity representa a vanguarda dessa transição, redefinindo o papel do desenvolvedor de "escritor de código" para "arquiteto de intenções".1Diferente de editores que reagem a toques de tecla, a Antigravity opera sob um modelo de execução multi-agente assíncrono. Ela introduz o conceito de "Agent Manager", uma interface dedicada onde tarefas de longo horizonte — como "refatorar este módulo de geometria" ou "auditar a conformidade com a Matriz K-12" — são delegadas a agentes autônomos.3 Para o projeto 'Matemática Viva', isso é fundamental. A criação de material didático que respeite simultaneamente a narrativa viva de Charlotte Mason e a progressão concreta-pictórica-abstrata de Singapura não é uma tarefa linear de autocompletar; é um problema de satisfação de restrições complexas que exige planejamento, execução e, crucialmente, verificação autônoma.A pesquisa indica que a Antigravity, sendo um fork do VS Code, mantém a compatibilidade com o ecossistema de extensões existente, mas substitui o paradigma de "chat linear" (comum no Copilot ou ChatGPT) por um fluxo de trabalho onde agentes podem planejar, usar o terminal, controlar o navegador e gerar artefatos complexos (arquivos, diffs, diagramas) de forma independente.51.2 O Desafio da Racionalidade em LLMs e a Solução PoetiqApesar dos avanços dos modelos de fronteira, a "inteligência fluida" genuína — a capacidade de raciocinar sobre problemas novos e abstratos sem alucinação ou regressão à média — permanece elusiva em abordagens de prompting direto ("zero-shot" ou "few-shot").7 É neste hiato que a tecnologia da Poetiq.ai se insere.A Poetiq não propõe apenas um novo modelo, mas um meta-sistema ou "andaime cognitivo" (scaffold). Sua arquitetura, que alcançou resultados recordes (SOTA) no benchmark de raciocínio abstrato ARC-AGI-2, baseia-se na premissa de que o prompt é uma interface, não a inteligência em si.7 Em vez de solicitar uma resposta única, o sistema Poetiq orquestra um loop recursivo:Geração: O modelo propõe múltiplas soluções candidatas.Verificação (Self-Auditing): O sistema executa ou simula essas soluções contra um conjunto de testes (no caso do ARC, exemplos de entrada/saída; no 'Matemática Viva', regras de governança).Refinamento: O feedback da verificação é reintroduzido no modelo, que "depura" seu próprio raciocínio e tenta novamente.Esta abordagem de "Test-Time Compute" (computação no momento do teste) permite que modelos como o Gemini 3 Pro superem seu desempenho base, alcançando níveis de precisão que modelos muito maiores não conseguem em uma única tentativa.7 Para o 'Matemática Viva', aplicar a lógica da Poetiq significa transformar a criação de uma aula em um processo iterativo onde o agente não para até que a "compilação pedagógica" seja bem-sucedida.1.3 A Tríade Tecnológica e PedagógicaA proposta deste relatório é fundir três pilares tecnológicos para servir a três pilares pedagógicos:TecnologiaFunção no SistemaPilar Pedagógico CorrespondenteAplicação PráticaAntigravity (ADK)Orquestração e AmbienteGovernança (Constituição)O ambiente onde as regras são aplicadas e o trabalho é executado.Poetiq (Lógica)Raciocínio RecursivoSingapura (Metodologia)A validação lógica rigorosa da progressão matemática (CPA).MCP (Contexto)Injeção de ConhecimentoCharlotte Mason / TGTBO fornecimento de contexto "vivo" e estético para a narrativa.A integração destas tecnologias não é trivial. Exige o domínio do Agent Development Kit (ADK) da Google para criar agentes customizados em Python que encapsulem os loops da Poetiq, e a configuração de servidores Model Context Protocol (MCP) para servir os documentos de governança como dados estruturados e consultáveis.92. A Arquitetura Poetiq: Desconstrução e AdaptaçãoPara integrar a ferramenta Poetiq, primeiro é necessário dissecar seu funcionamento interno, conforme revelado em seus repositórios open-source e publicações técnicas, e mapear esses componentes para o domínio do desenvolvimento de software educacional.2.1 O Meta-Sistema de Refinamento IterativoA inovação central da Poetiq, validada no benchmark ARC-AGI, é o tratamento da geração de soluções como um problema de busca e otimização, não de predição de texto estatística.82.1.1 O Ciclo de Vida da Solução PoetiqO sistema Poetiq opera em um ciclo fechado que pode ser descrito em quatro estágios críticos:Exploração Divergente: O sistema utiliza um modelo de "pensamento profundo" (como o Gemini 3 Pro em modo High Thinking) para gerar um espectro de abordagens potenciais para um problema. No contexto do ARC, isso significa gerar múltiplos programas Python que tentam transformar a grade de entrada na de saída.12Execução Concreta: Diferente de um chat normal, o sistema executa o código gerado. Isso fornece um sinal de verdade inquestionável (ground truth). O código roda ou falha; a saída corresponde aos exemplos ou não.Análise de Erro e Convergência: Se a execução falha, o stack trace ou a saída incorreta são devolvidos ao modelo. O modelo analisa por que falhou (ex: "Errei ao assumir simetria rotacional") e gera uma nova versão corrigida.Votação e Seleção: Em configurações avançadas, múltiplos agentes resolvem o problema em paralelo, e um mecanismo de votação (ensemble) seleciona a solução mais robusta.112.1.2 Adaptação para 'Matemática Viva'No domínio do 'Matemática Viva', não temos "grades de pixels", mas temos restrições igualmente rígidas definidas na Matriz K-12 e na Magna Carta.O "Código" é o Currículo: Podemos tratar um arquivo de aula (Markdown, LaTeX ou JSON) como "código" que precisa "compilar".O "Compilador" é a Governança: O erro não é um SyntaxError do Python, mas um PedagogyError: "Violação da Regra 4 da Magna Carta: O conceito abstrato foi introduzido sem suporte pictórico prévio."O "Debug" é a Revisão: O agente recebe esse erro e reescreve a seção específica da aula para incluir a etapa pictórica (ex: barras de Singapura) antes da fórmula abstrata.2.2 Modelos de Raciocínio: Gemini 3 Pro e Claude OpusA eficácia do "scaffold" Poetiq depende intrinsecamente da qualidade do modelo subjacente. A integração na Antigravity permite o uso híbrido:Gemini 3 Pro (Deep Think): A Google descreve o modo "Deep Think" como capaz de gerar múltiplos caminhos de raciocínio e auto-verificação nativa.13 A integração via Antigravity oferece acesso privilegiado a este modelo, permitindo ajustar o thinking_level para "High" em tarefas de design de currículo complexo, e "Low" para tarefas de formatação simples, otimizando custos.15Claude Opus/Sonnet (Thinking): Os modelos da Anthropic, especialmente a série 4.5, destacam-se na manutenção de contextos longos e na geração de código estruturado.16 A capacidade de "Computer Use" do Claude (controlar o navegador para verificar a renderização visual de uma aula) complementa o raciocínio lógico do Gemini.18 A arquitetura Poetiq é agnóstica ao modelo, permitindo que a Antigravity roteie a tarefa para o modelo que oferecer a melhor performance para o tipo específico de raciocínio exigido (ex: Gemini para lógica matemática de Singapura, Claude para a narrativa literária de Mason).83. Infraestrutura Técnica: Google Antigravity e ADKA Antigravity não é apenas um editor de texto; é uma plataforma de orquestração. Para implementar a lógica Poetiq, utilizaremos o Agent Development Kit (ADK), especificamente sua implementação em Python.3.1 O Agent Development Kit (ADK)O ADK fornece as primitivas necessárias para construir agentes que não apenas "respondem", mas "trabalham".Agentes Customizados: O ADK permite estender a classe BaseAgent para criar lógicas de execução arbitrárias. É aqui que o algoritmo da Poetiq será codificado. Em vez de usar o LlmAgent padrão (que faz uma chamada de API e retorna), criaremos um PoetiqReasoningAgent que encapsula o loop while not verified: refine().19Ferramentas (Tools): O ADK permite que funções Python sejam expostas aos agentes como ferramentas. Criaremos ferramentas que representam os validadores da "Constituição" e da "Matriz K-12". O agente chamará check_compliance(lesson_content) da mesma forma que chamaria uma calculadora.20Gerenciamento de Estado (Session/Memory): A criação de um currículo é um processo longo. O ADK gerencia a sessão e a memória, permitindo que o agente mantenha o contexto das decisões pedagógicas tomadas em etapas anteriores (ex: "Lembre-se que na aula passada introduzimos frações usando pizzas, então agora devemos usar barras para variar, conforme TGTB").223.2 O Papel do Model Context Protocol (MCP)A integração de dados externos é crítica. Os documentos de governança do 'Matemática Viva' não podem ser alucinados; eles devem ser citados com precisão. O MCP resolve isso padronizando a conexão entre a IDE e os dados.10MCP Servers: Implementaremos servidores MCP locais que indexam a Constituição, a Magna Carta e a Matriz K-12.Recursos e Prompts: O MCP permite expor "Recursos" (textos estáticos, como a Constituição) e "Prompts" (templates de instrução, como "Analise este texto sob a ótica de Charlotte Mason") diretamente na interface da Antigravity. Isso garante que o agente sempre tenha acesso à versão mais atualizada das regras de governança, sem necessidade de fine-tuning do modelo.244. Implementação Prática: Integrando Poetiq na AntigravityEsta seção detalha o roteiro técnico para a construção do sistema. A implementação é dividida em configuração do ambiente, desenvolvimento do servidor de governança (MCP) e construção do agente de raciocínio recursivo (ADK).4.1 Configuração do Ambiente AntigravityA Antigravity baseia-se em workspaces. O primeiro passo é configurar um repositório que contenha tanto o código do projeto 'Matemática Viva' quanto a infraestrutura dos agentes.26Estrutura de Diretórios Proposta:matematica-viva-workspace/├──.antigravity/│   ├── rules.md                 # Axiomas da Constituição e Magna Carta (System Prompt Global)│   └── workflows/               # Definições de fluxos de trabalho do ADK├──.context/                    # Documentos brutos (PDFs/MDs da Governança)├── src/│   ├── agents/                  # Código Python dos Agentes ADK│   │   ├── init.py│   │   ├── architect_agent.py   # Agente Poetiq (Gera e Refina)│   │   ├── auditor_agent.py     # Agente de Compliance (Verifica)│   │   └── router.py            # Roteador de intenções│   ├── tools/                   # Ferramentas Python│   │   ├── governance_mcp.py    # Cliente para o servidor MCP│   │   └── pedagogy_utils.py    # Validadores lógicos (ex: checar sintaxe LaTeX)│   ├── governance_server/       # Servidor MCP Customizado│   │   ├── server.py│   │   └── data_loader.py│   └── main.py                  # Ponto de entrada do ADK├── mcp_config.json              # Configuração dos servidores MCP para a IDE├── pyproject.toml               # Dependências (google-adk, fastmcp, etc.)└── content/                     # Onde as aulas geradas serão salvas (Markdown/LaTeX)4.2 Construindo o Servidor de Governança (MCP)Para que os agentes respeitem "rigorosamente" os documentos, eles não devem depender apenas de sua memória de treinamento. Criaremos um servidor MCP usando a biblioteca fastmcp 25 que serve os documentos de governança como ferramentas determinísticas.Código Conceitual (src/governance_server/server.py):Pythonfrom mcp.server.fastmcp import FastMCP
import json

# Inicializa o servidor MCP
mcp = FastMCP("MatematicaViva-Governance")

# Carrega a Matriz K-12 na memória (ou conecta a um banco de dados)
K12_MATRIX = json.load(open("data/k12_matrix.json"))

@mcp.resource("governance://constitution")
def get_constitution() -> str:
    """Retorna o texto completo da Constituição do Projeto."""
    return open("data/constitution.md").read()

@mcp.tool()
def query_k12_standards(grade: int, topic: str) -> list[str]:
    """
    Retorna os padrões obrigatórios da Matriz K-12 para uma série e tópico.
    Ex: query_k12_standards(4, 'Fractions') -> ['Visualização com barras', 'Vocabulário: numerador']
    """
    return K12_MATRIX.get(str(grade), {}).get(topic,)

@mcp.tool()
def validate_methodology(content: str, method: str) -> dict:
    """
    Valida um trecho de conteúdo contra uma metodologia específica (Singapore, Mason, TGTB).
    Retorna um objeto com {valid: bool, feedback: str}.
    """
    # Lógica de validação (pode chamar um modelo menor para classificar ou usar regras regex)
    # Exemplo simplificado:
    if method == "Singapore" and "concreto" not in content.lower():
        return {"valid": False, "feedback": "Falta etapa concreta antes da abstração."}
    return {"valid": True, "feedback": "Conformidade verificada."}

if __name__ == "__main__":
    mcp.run()
Este servidor é registrado no mcp_config.json da Antigravity, tornando as ferramentas query_k12_standards e validate_methodology acessíveis a qualquer agente dentro da IDE, seja ele Gemini ou Claude.284.3 Desenvolvendo o Agente Meta-Racional (Python ADK)Aqui reside a integração da lógica Poetiq. Criaremos um agente que não apenas chama o LLM, mas implementa o loop de refinamento. Utilizaremos a classe Agent do ADK e estenderemos seu comportamento.Código Conceitual (src/agents/architect_agent.py):Pythonimport asyncio
from google.adk import Agent, Event
from google.adk.types import Model
# Importamos as ferramentas MCP configuradas anteriormente

class PoetiqArchitectAgent(Agent):
    def __init__(self, model_name="gemini-3-pro", **kwargs):
        super().__init__(model=model_name, **kwargs)
        self.max_refinements = 5

    async def _run_async_impl(self, context):
        """
        Implementação do Loop Poetiq: Gerar -> Verificar -> Refinar
        """
        user_intent = context.input_message.text
        
        # 1. Planejamento (Recuperação de Contexto via MCP)
        # O agente consulta a Matriz K-12 antes de escrever qualquer coisa
        grade_level = extract_grade(user_intent) # Lógica auxiliar
        topic = extract_topic(user_intent)
        standards = await context.tools.query_k12_standards(grade=grade_level, topic=topic)
        
        system_prompt = f"""
        Você é o Arquiteto do Matemática Viva.
        Restrições da Matriz K-12: {standards}
        Tríade Pedagógica: Charlotte Mason (Narrativa), Singapura (CPA), TGTB (Estética).
        """

        current_draft = ""
        history =

        # Loop de Refinamento (A "Mágica" da Poetiq)
        for attempt in range(self.max_refinements):
            yield Event(type="thinking", data=f"Tentativa de geração {attempt+1}/{self.max_refinements}...")
            
            # Geração do Rascunho
            draft_response = await self.model.generate(
                prompt=f"{system_prompt}\nHistórico de Críticas: {history}\nTarefa: {user_intent}",
                thinking_mode="high" # Ativa o Deep Think do Gemini 3
            )
            current_draft = draft_response.text

            # Verificação (Self-Audit com Agente Auditor Virtual)
            # Aqui invocamos as ferramentas de validação do MCP
            audit_result = await self.audit_content(current_draft, standards)
            
            if audit_result['is_valid']:
                yield Event(type="success", data="Conteúdo validado com sucesso pela governança.")
                yield Event(type="output", data=current_draft)
                return
            else:
                # Se falhar, o feedback alimenta a próxima iteração
                yield Event(type="warning", data=f"Falha na validação: {audit_result['feedback']}")
                history.append(f"Rascunho {attempt}: Falhou. Motivo: {audit_result['feedback']}")

        yield Event(type="error", data="Não foi possível gerar conteúdo conforme após múltiplas tentativas.")

    async def audit_content(self, content, standards):
        # Lógica que combina chamadas ao MCP e verificação heurística
        # 1. Verifica aderência à Matriz (ferramenta MCP)
        # 2. Verifica tom de voz Charlotte Mason (via LLM secundário/Claude)
        # 3. Verifica progressão Singapura (lógica customizada)
        pass
Este código traduz a teoria da Poetiq em prática. O agente não "adivinha" a aula; ele a constrói iterativamente, consultando as regras do projeto a cada passo.5. A Tríade Pedagógica como Código: Implementação EspecíficaPara garantir que a "Tríade Pedagógica" (Mason, Singapura, TGTB) não seja apenas uma sugestão estilística, mas um requisito funcional, devemos codificar seus princípios em verificações automatizadas dentro do loop Poetiq.5.1 Matemática de Singapura (O Modelo CPA)O método de Singapura exige uma progressão estrita: Concreto -> Pictórico -> Abstrato.Implementação: O Auditor Agent verifica a estrutura do arquivo Markdown gerado.Regra de Validação: Se o tópico introduz um conceito novo, o documento deve conter uma seção de "Exploração Concreta" (sugerindo manipulativos) e uma seção "Pictórica" (imagens/diagramas) antes de qualquer notação numérica abstrata (equações).Ação Poetiq: Se o agente gerar uma aula que pula direto para 2 + 2 = 4, o validador retorna erro: "Violação CPA: Abstração prematura detectada". O agente reescreve a aula inserindo a etapa de "contar maçãs" (Concreto).5.2 Charlotte Mason (Ideias Vivas e Narrativa)Mason defende o uso de "livros vivos" e narrativas ricas, evitando a linguagem seca e utilitária dos livros didáticos comuns.Implementação: Utilizamos o Claude Opus (via API no ADK) como o especialista em estilo literário.Prompt de Verificação: "Analise este texto. Ele usa uma linguagem narrativa e envolvente ou é seco e instrucional? Dê uma nota de 0 a 10 na escala 'Living Book'. Se for < 8, reescreva."Integração: O agente principal (Gemini) gera a estrutura lógica matemática. Em seguida, delega seções de texto ao Claude para "masonificar" a linguagem, garantindo o tom correto.5.3 The Good and the Beautiful (TGTB - Estética e Valores)TGTB foca na beleza estética, conexão com a natureza e valores morais/familiares saudáveis.Implementação: Validação multimodal e de conteúdo.Verificação de Imagens: Se o agente sugerir imagens, o validador checa se elas são de "alta beleza estética" (arte clássica, natureza) e não desenhos animados genéricos (clipart).Filtro de Valores: O MCP de Governança contém uma lista de temas alinhados e desalinhados. O agente verifica se os exemplos matemáticos (problemas de texto) utilizam contextos positivos (natureza, família, construção) em vez de neutros ou negativos.6. Governança, Manutenção e Otimização de Custos6.1 Governança Viva via Constituição DigitalA "Constituição" e a "Magna Carta" do projeto deixam de ser documentos estáticos em PDF. Elas se tornam bancos de dados vetoriais ou regras lógicas dentro do servidor MCP.Rastreabilidade: Cada aula gerada pela Antigravity vem acompanhada de um manifesto de conformidade (um arquivo JSON gerado pelo agente), listando quais artigos da Constituição foram consultados e validados durante a criação. Isso oferece auditoria completa.6.2 Otimização de Custos com Modelos "Thinking"A pesquisa da Poetiq revelou que o uso inteligente de modelos menores em loops de refinamento pode ser mais econômico que usar modelos massivos de forma bruta.7Estratégia Híbrida:Roteamento e Rascunho Inicial: Usar Gemini 3 Flash. É extremamente rápido e barato, ideal para estruturar a aula.Refinamento e Lógica Complexa: Usar Gemini 3 Pro (Deep Think) apenas nas iterações onde o auditor detecta falhas lógicas ou pedagógicas complexas.Polimento Literário: Usar Claude Sonnet 3.5/Opus pontualmente para a camada Charlotte Mason.Esta orquestração é gerenciada pelo script main.py do ADK, que pode trocar dinamicamente o modelo do agente baseando-se na complexidade da tarefa ou no número de falhas de validação.6.3 Manutenção Recursiva (Self-Healing)O sistema permite a manutenção proativa do projeto 'Matemática Viva'.Cenário: A Matriz K-12 é atualizada; o tópico "Frações" passa do 3º para o 4º ano.Ação: Um agente de manutenção varre o repositório. Ele consulta o MCP da Matriz atualizada, detecta que as aulas de Frações do 3º ano agora violam a governança.Correção: O agente move os arquivos, ajusta a linguagem para o nível de leitura do 4º ano (usando regras Mason de complexidade textual) e submete um Pull Request com as mudanças, tudo autonomamente.7. Workflow Operacional: Um Dia na Vida do ProjetoPara ilustrar a potência dessa integração, descrevemos o fluxo de trabalho de um desenvolvedor de currículo usando a Antigravity configurada:Input: O usuário abre o Agent Manager e digita: "Criar módulo introdutório de Geometria para 2º ano, focando em formas na natureza, seguindo estritamente a Constituição."Análise: O Agente Roteador recebe o pedido. Consulta o MCP para ver os padrões de Geometria do 2º ano na Matriz K-12.Geração (Ciclo Poetiq):Iteração 1: O Agente Arquiteto gera uma aula.Auditoria: O Agente Auditor rejeita: "A aula usa definições abstratas de 'polígono' muito cedo. Violação do princípio CPA (Singapura). Faltam exemplos da natureza (TGTB)."Iteração 2: O Arquiteto refina. Substitui definições por uma atividade de "caça ao tesouro" de formas em folhas e flores (Concreto + Natureza).Auditoria: "Aprovado. Linguagem narrativa adequada."Entrega: A IDE cria os arquivos aula_geometria_natureza.md, guia_professor.pdf e o relatório compliance_check.json.Resultado: O usuário recebe um material que já nasceu em conformidade, economizando horas de revisão humana.8. ConclusãoA integração da ferramenta Poetiq na IDE Antigravity representa um salto qualitativo para o projeto 'Matemática Viva'. Ao fundir a capacidade de raciocínio recursivo da Poetiq com a infraestrutura agêntica da Google e a governança estruturada via MCP, cria-se um sistema onde a tecnologia não apenas auxilia, mas garante a integridade pedagógica.Este relatório recomenda a adoção imediata da arquitetura proposta, começando pelo desenvolvimento dos servidores MCP de governança e pela codificação dos agentes ADK customizados em Python. O resultado será um ecossistema educacional vivo, capaz de crescer, se corrigir e manter a fidelidade aos seus princípios fundadores com uma eficiência sem precedentes.ComponenteTecnologia BaseFunção no 'Matemática Viva'Arquiteto de CurrículoPython ADK + Gemini 3Criação de conteúdo via loop Poetiq.Auditor de GovernançaMCP Server + RegrasValidação contra Constituição e Matriz K-12.Estilista PedagógicoClaude Opus (API)Ajuste de tom (Charlotte Mason) e estética (TGTB).AmbienteAntigravity IDEOrquestração assíncrona e interface humana.A era da "Engenharia Pedagógica Agêntica" chegou, e a arquitetura aqui delineada coloca o 'Matemática Viva' na fronteira dessa revolução.